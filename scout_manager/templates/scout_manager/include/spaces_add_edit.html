{% load staticfiles %}
{% csrf_token %}

<div class="mgr-content-header clearfix">

    <div style="padding: 0 15px;">
        <h2 style="display:inline-block;">{% if spot.name %}{{ spot.name }}{% else %}Add New Space{% endif %}</h2>
        <div style="display:inline-block; float:right;">{{ spot.etag }}&nbsp;&nbsp;<input type="button" value="Save Changes" style="display:inline-block;"></input></div>

        <div id="pub_error"></div>
        
    </div>
</div>

<h3>General Info</h3>

<label for="space-name">Name:
    <input id="space-name" type="text" name="name" value="{% if spot.name %}{{ spot.name }}{% endif %}" required="required" />
    <input type="hidden" name="id" value="{{ spot.spot_id }}" />
    <input type="hidden" name="etag" value="{{ spot.etag }}" />
</label>

<fieldset>
    <legend>Primary use: (required)</legend>

    <div style="float:left; width:25%; margin-right:1%;">

        {% if spot.app_type == "food" %}
            <label><input type="radio" name="extended_info:app_type" required value="food" checked>Food</label>
            <label><input type="radio" name="extended_info:app_type" required value="study" disabled>Study</label>
            <p>Please contact ADMINS if you need to change this space's app_type</p>
        {% elif spot.app_type == "study" %}
            <label><input type="radio" name="extended_info:app_type" required value="food" disabled>Food</label>
            <label><input type="radio" name="extended_info:app_type" required value="study" checked>Study</label>
            <p>Please contact ADMINS if you need to change this space's app_type</p>
        {% else %}
            <div id="add_new_extended_info">
                <label><input type="radio" name="extended_info:app_type" value="food">Food</label>
                <label><input type="radio" name="extended_info:app_type" value="study">Study</label>
            </div>
        {% endif %}

    </div>

    <div style="float:left; width:74%;">
        {% if spot.app_type == "food" %}
            {% include "scout_manager/include/extend_food.html" %}
        {% elif spot.app_type == "study" %}
            {% include "scout_manager/include/extend_study.html" %}
        {% else %}
            <p>Choose the primary use for this space... and extended info fields will appear below!</p>
            <div id="extended_food_template" style="display:none;">
            {% include "scout_manager/include/extend_food.html" %}
            </div>
            <div id="extended_study_template" style="display:none;">
            {% include "scout_manager/include/extend_study.html" %}
            </div>
        {% endif %}
    </div>

</fieldset>

<label for="space-description">Description:
    <textarea name="extended_info:location_description" id="space-description" type="text">{% if spot.location_description %}{{spot.location_description}}{% endif %}</textarea>
</label>

<fieldset>

    <legend>Images</legend>

    <label>Choose: <input type="file" name="" accept="image/*" id="mgr_upload_image"></label>

    <p>Preview images:</p>

    <ul id="mgr_list_spot_images">
        {% for image in spot.images %}
         <li>
             <img src="/images/{{ spot.spot_id }}/image/{{ image.image_id }}?width=100">
             <label for="study-default-image-1" class="scope"><input type="radio" name="default-study-img" id="study-default-image-1" />default</label>
             <input type="button" value="Delete image" class="mgr-delete-image" />
         </li>
        {% endfor %}
    </ul>
    <p id="mgr_list_spot_empty">Image list is empty! Add some images.</p>

</fieldset>

<fieldset class="clearfix">
    <legend>Location:</legend>

    <div style="float:left; width:25%; margin-right:1%;">
        <label for="space-campus" required>Campus:
            <select name="extended_info:campus">
                <option disabled selected value>select a campus...</option>
                <option value="seattle" {% if spot.campus == "seattle" %} selected {% endif %}>Seattle</option>
                <option value="bothell" {% if spot.campus == "bothell" %} selected {% endif %}>Bothell</option>
                <option value="south_lake_union" {% if spot.campus == "south_lake_union" %} selected {% endif %}>South Lake Union</option>
                <option value="tacoma" {% if spot.campus == "tacoma" %} selected {% endif %}>Tacoma</option>
            </select>
        </label>

        <label for="space-latitude">Latitude:
            <input name="location:latitude" id="space_latitude" type="text" value="{% if spot.latitude %}{{ spot.latitude }}{% endif %}" required />
        </label>

        <label for="space-longitude">Longitude:
            <input name="location:longitude" id="space_longitude" type="text" value="{% if spot.longitude %}{{ spot.longitude }}{% endif %}" required />
        </label>

        {# How are we determining this? #}
        <label class="dummy"><input type="checkbox" value="Outdoor" disabled>Outdoor location</label>

        <!-- Hide if outdoor location. We suggest/enforce building options. -->
        <label for="building-name">Building:
            <select name="location:building_name">
                <option disabled selected value>select a building...</option>
                {% for building in buildings %}
                <option value="{{ building }}" {% if spot.building_name == building %} selected {% endif %}>{{ building }}</option>
                {% endfor %}
            </select>
        </label>

        <!-- Hide if outdoor location. We suggest floor options. -->
        <label for="floor">Floor:
            <input id="floor" name="location:floor" type="text" value="{% if spot.floor %}{{ spot.floor }}{% endif %}">
        </label>

        <!-- Hide if outdoor location -->
        <label for="room-number">Room #:
            <input id="room-number" name="location:room_number" type="text" value="{% if spot.room_number %}{{ spot.room_number }}{% endif %}">
        </label>

        {# How are we determining this? #}
        <label class="dummy"><input type="checkbox" value="ADA" disabled>ADA Accessible</label>
    </div>
    <div style="float:left; width:74%;">
        <label for="space-latitude">
            Location chooser:
            <div style="border: solid 1px #c8c8c8; border-radius:3px; height:500px; margin: 8px 0;" id="gmap_chooser">Google Maps here</div>
            <p>If new, click on map to drop a pin on the location of your space and drag marker for precise positioning.</p>
            <p>If edit, drag the marker to the desired location of the space.</p>
        </label>
    </div>

</fieldset>

<h3>Current Alert</h3> {# we need to set has_alert too to show it #}
<label><input name="extended_info:has_alert" type="checkbox" value="has_alert" {% if spot.has_alert %}checked{% endif %}>Alert Enabled</label>

<label for="alert-notes">Post this Alert message:
    <textarea id="alert-notes" name="extended_info:alert_notes" type="text" value="{% if spot.alert_notes %}{{ spot.alert_notes }}{% endif %}"></textarea>
</label>

<!-- include the hour and access form -->
{% include "scout_manager/include/form_hours.html" %}

<h3>Administration</h3>

<fieldset>
    <legend>Contact Info</legend>
    <label for="owner">Owner/Admin Group:<input id="owner" name="extended_info:owner" type="text" value="{% if spot.owner %}{{ spot.owner }}{% endif %}"></label>
    <label for="manager-name">Manager Name:<input id="manager-name" name="manager" type="text" value="{% if spot.manager %}{{ spot.manager }}{% endif %}"></label>
    <label for="email" class="">Email:<input id="email" type="email" value="{% if spot.email %}{{ spot.email }}{% endif %}"></label>
    <label for="phone" class="">Phone:<input id="phone" name="phone" type="tel" value="{% if spot.phone %}{{ spot.phone }}{% endif %}"></label>
</fieldset>

<!--
<h3>Item Integration</h3>

<fieldset>
    <legend>Items</legend>
    <p><a href="/manager/items/add/">Add New Item</a></p>
    <p>Total: <span class="dummy">Total # of items in items list</span></p>
    <ol>
        <li>
            <div><a href="/manager/items/601234">Edit</a></div>
            <div>Name: <span class="dummy">item.name</span></div>
            <div>Type:<span class="dummy">item_type.name</span></div>
            <div>Category:<span class="dummy">item_category.name</span></div>
            <div>Brand:<span class="dummy">item.brand</span></div>
            <div>Model:<span class="dummy">item.model</span></div>
            <div>Quantity:<span class="dummy">item.quantity</span></div>
            <div>STF Funded: <span class="dummy">Yes</span></div>
            <div>
                <input type="button" value="Delete item" class="dummy"></input>
            </div>
        </li>
        <li>
            <div><a href="/manager/items/475786">Edit</a></div>
            <div>Name: <span class="dummy">item.name</span></div>
            <div>Type:<span class="dummy">item_type.name</span></div>
            <div>Category:<span class="dummy">item_category.name</span></div>
            <div>Brand:<span class="dummy">item.brand</span></div>
            <div>Model:<span class="dummy">item.model</span></div>
            <div>Quantity:<span class="dummy">item.quantity</span></div>
            <div>STF Funded: <span class="dummy">Yes</span></div>
            <div>
                <input type="button" value="Delete item" class="dummy"></input>
            </div>
        </li>
    </ol>
</fieldset>
-->


<h3>Space Actions</h3>
<!-- When a user clicks to change status to PUBLISH, then we should validate form. It would be ideal to provide them with a condensed list of required and invalid fields that they need to address (maybe as intersticial, which they can cancel from. -->

<fieldset>
    <legend>Publish Status</legend>
    <p>Status: <span>{% if spot.is_hidden %}UNPUBLISHED{% else %}PUBLISHED <a href="/detail/{{ spot.spot_id }}" target="_blank">preview in client</a>{% endif %}</span></p>
    <p>Unpublish?:&nbsp;<input type="checkbox" name="extended_info:is_hidden"{% if spot.is_hidden %} checked{% endif %}></input></p>
</fieldset>

<!--
    <div class="dummy" style="margin-bottom:2em;">
        <input type="submit" value="Save Changes" />
        <input type="button" value="Cancel" />
    </div>

    <div class="dummy" style="margin-bottom:2em;">
        <input type="button" value="Download CSV of Space"></input>
    </div>

    <div class="dummy">
        <input type="button" value="Delete Space"></input>
    </div>


<h3>Incomplete items</h3>
<p>You must complete </p>
<ul class="dummy">
    <li>Invalid field name 1</li>
    <li>Invalid field name 2</li>
</ul>

-->
